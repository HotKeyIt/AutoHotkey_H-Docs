<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><title>ahktextdll</title>

<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/jquery.js" type="text/javascript"></script>
<script src="../static/tree.jquery.js" type="text/javascript"></script>
<script src="../static/content.js" type="text/javascript"></script>
</head>
<body>
<h1>ahktextdll</h1>
<p>Exported function to create additional AutoHotkey thread in
current process from a file on disk or network.<br>
If a thread is already executed it will terminated before new thread
starts.<br>
Note you will need to load AutoHotkey.dll module using LoadLibrary
before you can use this function, see Example.<br>
<strong>This function is only available in AutoHotkey[Mini].dll</strong></p>
<br>
<pre class="Syntax">DllCall, <strong>OutPutVar</strong>, AutoHotkey.dll<strong>\ahktextdll</strong>, Str, Script, Str, Parameters, CDecl UPTR
<pre><em>Command  Example:</em> DllCall, <strong>hThread</strong>, AutoHotkey.dll\ahktextdll, Str, MsgBox From Thread, Str,, CDecl UPTR
<em>Function Example:</em> <strong>hThread</strong> := DllCall("AutoHotkey.dll\ahktextdll", "Str", "MsgBox From Thread" ,"Str", "", "PTR")
</pre></pre>
<h3>Parameters</h3>
<dl>
  <dt>OutPutVar</dt>
    <dd><p>The name of the variable in which to store the handle of newly created thread. </p>
    </dd>
<dt>Script (optional)</dt>
<dd>
<p>String containing new AutoHotkey script to be
executed in AutoHotkey[Mini].dll. When omitted, following script is used: <pre>#Persistent<br>#NoTrayIcon</pre></p>
</dd>
<dt>Parameters (optional)</dt>
<dd>
<p>Command line
parameters that will be available in built-in variable <strong><a href="Variables.htm#CommandLine">A_Args</a></strong>
object.</p>
</dd>
</dl>
<h3>General Remarks</h3>
<dd>
<p>ahkdll behaves different when instead of MyScript.ahk an
empty string or 0 is passed:<br>
</p>
<ul>
<li>If AutoHotkey.dll is compiled, the compiled script is
executed.</li>
<li>Otherwise an empty, persistent Script will be started.</li>
</ul>
<br>When exe was started with command line parameters, the dll will be
able to grab the parameters and use same library as well as A_ScriptDir
and A_ScriptFullPath as the executable. When executable is compiled,
the path of the executable will be used.
</dd>
</dl>
<h3>Related</h3>
<p><a href="ahktextdll.htm">ahktextdll()</a>, <a href="../AutoHotkeyDll.htm">AutoHotkey.dll</a>, <a href="AutoHotkey.htm#Mini">OnClipboardChange</a>, <a href="PostMessage.htm">Post/SendMessage</a>, <a href="../Functions.htm">Functions</a>, <a href="../misc/SendMessageList.htm">List of Windows Messages</a>,
<a href="../misc/Threads.htm">Threads</a>, <a href="Critical.htm">Critical</a>, <a href="DllCall.htm">DllCall()</a></p>
<h3>Examples</h3>
<pre class="NoIndent">dllpath:=A_ScriptDir "\AutoHotkey.dll"<br>DllCall("LoadLibrary","Str",dllpath) <em>; Load the AutoHotkey module.</em><br>DllCall(dllpath "\ahkdll","Str",A_ScriptDir "\MyDllScript.ahk","Str","") <em>; start a new thread from file.</em><br>While DllCall(dllpath "\ahkReady")<br>Sleep 100 <em>; wait for the thread to exit</em><br>DllCall(dllpath "\ahktextdll","Str","MsgBox Another Hello World MsgBox!","Str","") <em>; Automatically exits current thread and starts a new thread from string.</em>
</pre>
</body></html>